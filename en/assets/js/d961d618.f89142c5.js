"use strict";(self.webpackChunktotem=self.webpackChunktotem||[]).push([[1618],{14522:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>k,toc:()=>p});var i=o(87462),a=(o(67294),o(3905)),n=o(13848);const l={title:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a",description:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a- HttpOnly/Secure/SameSite",keywords:["Tomcat","Cookie","HttpOnly","Secure","SameSite"]},r="Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a",k={unversionedId:"DevTech/Tomcat/Tomcat_Httponly",id:"DevTech/Tomcat/Tomcat_Httponly",title:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a",description:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a- HttpOnly/Secure/SameSite",source:"@site/docs/DevTech/Tomcat/Tomcat_Httponly.md",sourceDirName:"DevTech/Tomcat",slug:"/DevTech/Tomcat/Tomcat_Httponly",permalink:"/en/docs/DevTech/Tomcat/Tomcat_Httponly",draft:!1,tags:[],version:"current",frontMatter:{title:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a",description:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a- HttpOnly/Secure/SameSite",keywords:["Tomcat","Cookie","HttpOnly","Secure","SameSite"]},sidebar:"totem_sidebar",previous:{title:"Tomcat \u5ba2\u88fd\u932f\u8aa4\u9801",permalink:"/en/docs/DevTech/Tomcat/Tomcat_Error_Page"},next:{title:"Document List (Graphics)",permalink:"/en/docs/Graphics/docs-map"}},c={},p=[{value:"\u6e2c\u8a66\u74b0\u5883",id:"\u6e2c\u8a66\u74b0\u5883",level:2},{value:"\u53c3\u8003\u8cc7\u6599",id:"\u53c3\u8003\u8cc7\u6599",level:2},{value:"JQuery Cookie \u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f",id:"jquery-cookie-\u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f",level:2},{value:"wicket Framework \u4e2d\u8a2d\u5b9a\u65b9\u5f0f",id:"wicket-framework-\u4e2d\u8a2d\u5b9a\u65b9\u5f0f",level:2}],m={toc:p},s="wrapper";function u(e){let{components:t,...o}=e;return(0,a.kt)(s,(0,i.Z)({},m,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"tomcat-cookie-\u5b89\u5168\u6027\u8a2d\u5b9a"},"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a"),(0,a.kt)("h2",{id:"\u6e2c\u8a66\u74b0\u5883"},"\u6e2c\u8a66\u74b0\u5883"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u53d7\u7a3d\u6838\u7684\u820a\u7d71 "),(0,a.kt)("li",{parentName:"ul"},"Tomcat8.5"),(0,a.kt)("li",{parentName:"ul"},"JDK8")),(0,a.kt)("h1",{id:"cookie-\u53ef\u5206\u70ba"},"COOKIE \u53ef\u5206\u70ba"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"SESSION COOKIE ie JSESSIONID: \u7531 Tomcat Container \u6240\u7522\u751f\u8207\u7ba1\u7406\u3002"),(0,a.kt)("li",{parentName:"ul"},"Customized Cookie : \u9019\u908a\u6cdb\u6307\u958b\u767c\u6642\u81ea\u884c\u5efa\u7acb\u8207\u7dad\u8b77\u7684\u90e8\u5206\u3002"),(0,a.kt)("li",{parentName:"ul"},"3rd Cookie : \u5176\u4ed6 Libs \u6240\u5efa\u7acb\u8207\u4f7f\u7528\u3002")),(0,a.kt)("h1",{id:"tomcat-\u4e2d\u8207-jsessionidcookie-\u76f8\u95dc\u5168\u6027\u8a2d\u5b9a"},"Tomcat \u4e2d\u8207 JSESSIONID/Cookie \u76f8\u95dc\u5168\u6027\u8a2d\u5b9a"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"\u4e3b\u8981\u6703\u8a0e\u8ad6\u5230\u4e0b\u5217\u4e09\u9805",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#HttpOnly-id"},"HttpOnly")," : \u9650\u5236 Cookie \u50c5\u80fd\u7d93\u7531 Http(s) Protocol \u5b58\u53d6\u3002\u6240\u4ee5\u5176\u4ed6  JavaScript \u7121\u6cd5\u5b58\u53d6\u3002"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#Secure-id"},"Secure")," : Cookie \u50c5\u80fd\u5728\u52a0\u5bc6\u7684\u9023\u4e0b\u60c5\u5883\u4e0b\u4f7f\u7528\u3002\u4e5f\u5c31\u662f\u53c8\u518d\u4f9d\u7e2e\u9650\u5236\u53ea\u80fd\u5728 Https \u4e2d\u4f7f\u7528\u3002 "),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#SameSite-id"},"SameSite")," : \u540c\u6e90\uff0cCookie \u4e0d\u80fd\u8de8\u7db2\u7ad9\u5206\u4eab\u3002")))),(0,a.kt)("h1",{id:"httponly-\u7528\u9014-"},"HttpOnly \u7528\u9014 ",(0,a.kt)("span",{id:"HttpOnly-id"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Tomcat \u8a2d\u5b9a Cookie \u70ba HttpOnly \u6642\u610f\u5473\u8457\uff0cCookie \u50c5\u80fd\u7d93\u7531 http/https \u5b58\u53d6\uff0c\u5176\u4ed6 Script \u4e00\u5f8b\u7981\u6b62\u5b58\u53d6\u3002",(0,a.kt)("br",null),"\n\u7c21\u55ae\u7684\u8aaa\u6cd5\u662f\u700f\u89bd\u5668\u53ef",(0,a.kt)("span",{style:{color:"#0044FF"}},"\u62d2\u7d55\u8207\u4ed6\u4eba\u5982 JsvaScript \u5171\u4eab Cookies"),"\u3002",(0,a.kt)("br",null),"\n\u70ba\u4f55\u91cd\u8981 Cookie \u4e0d\u8a72\u5171\u4eab? \u8209\u4f8b\u4f86\u8aaa: \u5e38\u898b\u7684 cookie JSESSIONID \u82e5\u88ab\u7aca\u53d6\uff0c\u901a\u5e38\u9020\u6210 SESSION \u8207\u8eab\u5206\u88ab\u76dc\u7528\uff0c\n\u4e5f\u5c31\u662f\u8aaa HttpOnly \u4e3b\u8981\u76ee\u7684\u5728\u65bc\u9632\u6b62 ",(0,a.kt)("a",{parentName:"p",href:"https://owasp.org/www-community/attacks/xss/"},"XSS(Cross Site Scripting)")," \u653b\u64ca\u3002",(0,a.kt)("br",null))),(0,a.kt)("hr",null),(0,a.kt)("h1",{id:"secure-\u7528\u9014-"},"Secure \u7528\u9014 ",(0,a.kt)("span",{id:"Secure-id"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Secure \u8a2d\u70ba true \u610f\u5473\u8457 Cookie \u50c5\u80fd\u5728\u52a0\u5bc6\u7684\u7ba1\u9053\u4f7f\u7528\u3002\n\u8209\u4f8b\u4f86\u8aaa\uff0c\u964d\u4f4e\u98a8\u96aa\u7684\u6a5f\u5236\u70ba\u7576\u4e00\u500b https \u7db2\u7ad9\u82e5\u88ab\u5d4c\u5728 http \u7684\u91e3\u9b5a\u7db2\u7ad9\u5167\u6642\u3002\u56e0\u70ba Cookie \u88ab\u9650\u5236\u53ea\u80fd\u5728 https \u4e4b\u4e0b\u4f7f\u7528\u3002\n\u6240\u4ee5\u91e3\u9b5a\u7db2\u7ad9\u90e8\u5206\u529f\u80fd\u6703\u5931\u6548\u3002\u82e5\u662f\u8a72 Cookie \u70ba Session Cookie (\u5982: JSESSIONID)\u5247\u6703\u81ea\u52d5\u88ab\u767b\u51fa\u3002")),(0,a.kt)("hr",null),(0,a.kt)("h1",{id:"samesite-\u7528\u9014-"},"SameSite \u7528\u9014 ",(0,a.kt)("span",{id:"SameSite-id"})),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"\u540c\u6e90\uff0c\u9019\u908a\u89e3\u91cb\u5c31\u66f4\u5bb9\u6613\u7406\u89e3\u4e86\u3002Cookie \u7121\u6cd5\u8de8 Domain \u4f7f\u7528\u3002\u6240\u4ee5\u7576\u7db2\u7ad9\u88ab\u5167\u5d4c\u6642\uff0c\n\u7531\u65bc\u91e3\u9b5a\u7db2\u7ad9\u7684\u7db2\u5740 Domain \u662f\u507d\u9020\u7684\u4e00\u5b9a\u8207\u539f\u59cb\u7db2\u7ad9\u4e0d\u540c\u3002\u56e0\u6b64\u7121\u6cd5\u53d6\u7528 Cookies\u3002"),(0,a.kt)("blockquote",{parentName:"blockquote"},(0,a.kt)("p",{parentName:"blockquote"},"\u5ef6\u4f38\u95b1\u8b80 Line of Death"))),(0,a.kt)("hr",null),(0,a.kt)("h1",{id:"tomcat-jsessionid-httponly-\u8a2d\u5b9a\u65b9\u5f0f"},"Tomcat JSESSIONID HttpOnly \u8a2d\u5b9a\u65b9\u5f0f"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Tomcat7+ \u4e4b\u5f8c JSESSIONID \u7684 ",(0,a.kt)("span",{style:{color:"#0044FF"}},"HttpOnly \u5c6c\u6027\u9810\u8a2d\u70ba true"),"\u3002")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Tomcat7+ \u986f\u5f0f HttpOnly \u8a2d\u5b9a\u65b9\u5f0f\u9700\u540c\u6642\u8a2d\u5b9a"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"web.xml : cookie-config > http-only = true"),(0,a.kt)("li",{parentName:"ul"},"web.xml : cookie-config > secure = true"),(0,a.kt)("li",{parentName:"ul"},"server.xml : connector > secure = true"),(0,a.kt)("li",{parentName:"ul"},"context.xml : CookieProcessor > sameSiteCookies = strict"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"web.xml"),(0,a.kt)(n.dn,{text:"\n    <session-config>\n         <tracking-mode>COOKIE</tracking-mode>\n         <cookie-config>\n            <http-only>true</http-only>\n            <secure>true</secure>\n         </cookie-config>\n    </session-config>\n    ",language:"xml",showLineNumbers:"true",mdxType:"CodeBlock"})),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"server.xml"),(0,a.kt)(n.dn,{text:'\n        <Connector port="8080" protocol="HTTP/1.1"\n               connectionTimeout="20000"\n               redirectPort="8443" URIEncoding="UTF-8" secure="true"/>\n    ',language:"xml",showLineNumbers:"true",mdxType:"CodeBlock"})),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"context.xml"),(0,a.kt)(n.dn,{text:'\n<Context>\n    <CookieProcessor className="org.apache.tomcat.util.http.LegacyCookieProcessor" sameSiteCookies="strict" />      \n</Context>  \n    ',language:"xml",showLineNumbers:"true",mdxType:"CodeBlock"}))),(0,a.kt)("h1",{id:"\u6aa2\u67e5\u8a2d\u5b9a\u662f\u5426\u751f\u6548"},"\u6aa2\u67e5\u8a2d\u5b9a\u662f\u5426\u751f\u6548"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"* Chrome developer tool (F12) > Application > Storage Cookies \n")),(0,a.kt)("h1",{id:"\u5176\u4ed6"},"\u5176\u4ed6"),(0,a.kt)("h2",{id:"\u53c3\u8003\u8cc7\u6599"},"\u53c3\u8003\u8cc7\u6599"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://blog.51cto.com/u_9597987/3485720"},"HttpOnly \u7c21\u4ecb")),(0,a.kt)("li",{parentName:"ul"},"\u9632\u79a6 Cross-Site Scripting (XSS) ",(0,a.kt)("a",{parentName:"li",href:"https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/"},"Content-Security-Pilicy")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://devco.re/blog/2014/06/03/http-session-protection/"},"HTTP Session \u653b\u64ca\u8207\u9632\u8b77"),"  "),(0,a.kt)("li",{parentName:"ul"},"HttpOnly ",(0,a.kt)("a",{parentName:"li",href:"https://datatracker.ietf.org/doc/html/rfc6265"},"RFC 6265"))),(0,a.kt)("h2",{id:"jquery-cookie-\u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f"},"JQuery Cookie \u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.runoob.com/jquery/jquery-cookie-plugin.html"},"https://www.runoob.com/jquery/jquery-cookie-plugin.html")," "),(0,a.kt)("li",{parentName:"ul"},"jquery is js: \u6240\u4ee5\u7121\u6cd5\u7ba1\u7406\u8207\u8a2d\u5b9a\u8d85\u51fa\u81ea\u5df1\u6b0a\u9650\u7bc4\u570d\u7684 httponly \u5c6c\u6027"),(0,a.kt)("li",{parentName:"ul"},"\u6709\u4eba\u628a sameSite: 'strict' \u85cf\u5728 path \u5c6c\u6027\u4e4b\u4e2d\u3002\u5be6\u969b\u6e2c\u8a66\u53ef\u884c\u3002")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'tricky 1: \u653e\u5728 path\ntricky 2: \u5b57\u9996\u5927\u5beb\n\n$.cookie("testCookieName", "TestValue Name",{ expires : 30, path: "/;SameSite=strict"});\n')),(0,a.kt)("h2",{id:"wicket-framework-\u4e2d\u8a2d\u5b9a\u65b9\u5f0f"},"wicket Framework \u4e2d\u8a2d\u5b9a\u65b9\u5f0f"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'        WebResponse webResponse = (WebResponse) RequestCycle.get()\n                .getResponse();\n        Cookie cookie = new Cookie("showLeftColumn", "");\n        cookie.setPath("/");\n        cookie.setHttpOnly(true);\n        cookie.setSecure(true);\n        webResponse.addCookie(cookie);\n')))}u.isMDXComponent=!0}}]);