"use strict";(self.webpackChunkinsect_totem=self.webpackChunkinsect_totem||[]).push([[5702],{28453:(n,e,a)=>{a.d(e,{R:()=>t,x:()=>o});var r=a(96540);const s={},l=r.createContext(s);function t(n){const e=r.useContext(l);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:t(n.components),r.createElement(l.Provider,{value:e},n.children)}},58048:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>i,contentTitle:()=>o,default:()=>m,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"PostgreSQL/PostgreSql_index","title":"PostgreSQL \u8cc7\u6599\u5eab index","description":"PostgreSQL index","source":"@site/docs/140_PostgreSQL/PostgreSql_index.md","sourceDirName":"140_PostgreSQL","slug":"/PostgreSQL/PostgreSql_index","permalink":"/docs/PostgreSQL/PostgreSql_index","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"PostgreSQL \u8cc7\u6599\u5eab index","description":"PostgreSQL index","keywords":["postgresql","index"]},"sidebar":"totem_sidebar","previous":{"title":"PostgreSQL DB \u91cd\u5efa\u6307\u4ee4","permalink":"/docs/PostgreSQL/PostgreSQL_termination"},"next":{"title":"PostgreSQL \u532f\u51fa Blob \u6b04\u4f4d","permalink":"/docs/PostgreSQL/Postgres_Export_Blob_to_File"}}');var s=a(74848),l=a(28453);const t={title:"PostgreSQL \u8cc7\u6599\u5eab index",description:"PostgreSQL index",keywords:["postgresql","index"]},o=void 0,i={},c=[{value:"\u67e5\u8a62\u6240\u6709 index",id:"\u67e5\u8a62\u6240\u6709-index",level:2},{value:"\u67e5\u8a62\u6c92 index \u7684 FK",id:"\u67e5\u8a62\u6c92-index-\u7684-fk",level:2},{value:"\u5efa\u7acb\u8207\u522a\u9664 index \u8a9e\u6cd5",id:"\u5efa\u7acb\u8207\u522a\u9664-index-\u8a9e\u6cd5",level:2}];function d(n){const e={blockquote:"blockquote",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"\u7c21\u55ae\u5217\u51fa\u67e5\u8a62\u8207\u5efa\u7acb index \u7684\u65b9\u6cd5"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"\u67e5\u8a62\u6240\u6709-index",children:"\u67e5\u8a62\u6240\u6709 index"}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"postgres"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"    select a.schemaname, a.tablename, a.indexname, b.column_name\r\n          from pg_catalog.pg_indexes a,\r\n               information_schema.columns b\r\n          where a.tablename  = b.table_name\r\n           and a.schemaname = b.table_schema and a.schemaname = 'public'\r\n           and (    a.indexdef like '%(' || b.column_name || '%'\r\n                 or a.indexdef like '%, ' || b.column_name || '%'\r\n                 or a.indexdef like '%(\"' || b.column_name || '%'\r\n                 or a.indexdef like '%, \"' || b.column_name || '%' )\r\n         order by a.tablename, length(b.column_name);\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"oracle"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"table_owner \u4f9d\u5be6\u969b\u60c5\u6cc1\u66f4"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"    select * from sys.all_ind_columns\r\n     where table_owner = 'InsectTotem'\r\n     order by index_name;\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u67e5\u8a62\u6c92-index-\u7684-fk",children:"\u67e5\u8a62\u6c92 index \u7684 FK"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"foreign key \u6c92\u505a index \u6642\uff0c\u901a\u5e38 join \u6703\u8b8a\u6162"}),"\n",(0,s.jsx)(e.li,{children:"\u4f46\u5be6\u969b\u4ecd\u8981\u770b\u6548\u80fd\u72c0\u6cc1\u6c7a\u5b9a\u662f\u5426\u9808\u5efa\u7acb"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"postgres"})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"    select fkeys.table_name,\r\n           fkeys.constraint_name,\r\n           fkeys.column_name,\r\n           ind_cols.indexname\r\n      from (\r\n             select a.constraint_schema,\r\n                    a.table_name,\r\n                    a.constraint_name,\r\n                    a.column_name\r\n               from information_schema.key_column_usage a,\r\n                    information_schema.referential_constraints b\r\n              where a.constraint_name   = b.constraint_name\r\n                and a.constraint_schema = b.constraint_schema\r\n                and a.constraint_schema = 'public'\r\n           ) fkeys\r\n           left join\r\n           ( select a.schemaname, a.tablename, a.indexname, b.column_name\r\n               from pg_catalog.pg_indexes a,\r\n                    information_schema.columns b\r\n              where a.tablename  = b.table_name\r\n                and a.schemaname = b.table_schema and a.schemaname = 'public'\r\n                and (    a.indexdef like '%(' || b.column_name || '%'\r\n                      or a.indexdef like '%, ' || b.column_name || '%'\r\n                      or a.indexdef like '%(\"' || b.column_name || '%'\r\n                      or a.indexdef like '%, \"' || b.column_name || '%' )\r\n           ) ind_cols on (     fkeys.constraint_schema = ind_cols.schemaname\r\n                           and fkeys.table_name        = ind_cols.tablename\r\n                           and fkeys.column_name       = ind_cols.column_name )\r\n     \r\n     -- \u5982\u679c\u53ea\u60f3\u770b\u672a\u52a0\u4e0a index \u7684 FK\uff0c\u79fb\u9664\u6389\u4e0b\u9762\u7684 comment\r\n     -- where ind_cols.indexname is null\n"})}),"\n",(0,s.jsx)(e.p,{children:(0,s.jsx)(e.strong,{children:"oracle"})}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"owner name \u4f9d\u5be6\u969b\u60c5\u6cc1\u66f4\u6539"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"    select a.table_name,\r\n           a.constraint_name,\r\n           a.column_name,\r\n           c.index_name\r\n      from all_cons_columns a,\r\n           all_constraints b,\r\n           all_ind_columns c\r\n     where a.owner           = 'InsectTotem'\r\n       and b.constraint_type = 'R'\r\n       and a.owner           = b.owner\r\n       and a.table_name      = b.table_name\r\n       and a.constraint_name = b.constraint_name\r\n       and a.owner           = c.table_owner (+)\r\n       and a.table_name      = c.table_name  (+)\r\n       and a.column_name     = c.column_name (+)\r\n     \r\n     --\u5982\u679c\u53ea\u60f3\u770b\u672a\u52a0\u4e0a index \u7684 FK\uff0c\u79fb\u9664\u6389\u4e0b\u9762\u7684 comment\r\n     --and c.index_name      is null\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u5efa\u7acb\u8207\u522a\u9664-index-\u8a9e\u6cd5",children:"\u5efa\u7acb\u8207\u522a\u9664 index \u8a9e\u6cd5"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"index_mytable_mycol : index \u540d\u7a31\u4e00\u822c\u901a\u7528\u7684\u683c\u5f0f\uff0c\u81ea\u884c\u66f4\u63db"}),"\n"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-sql",children:"-- \u5efa\u7acb\r\n    create index index_mytable_mycol on mytable(mycol);\r\n    \r\n-- \u522a\u9664\r\n    drop index index_mytable_mycol;    \n"})})]})}function m(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}}}]);