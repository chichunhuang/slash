"use strict";(self.webpackChunkinsect_totem=self.webpackChunkinsect_totem||[]).push([[4692],{28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var r=s(96540);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}},65242:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"PostgreSQL/JSONB/PostgreSQL_Delete_attr","title":"\u522a\u9664 JSONB \u8cc7\u6599","description":"PostgreSQL JSONB \u6b04\u4f4d\u9375\u503c\u522a\u9664","source":"@site/docs/140_PostgreSQL/JSONB/010_PostgreSQL_Delete_attr.md","sourceDirName":"140_PostgreSQL/JSONB","slug":"/PostgreSQL/JSONB/PostgreSQL_Delete_attr","permalink":"/docs/PostgreSQL/JSONB/PostgreSQL_Delete_attr","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"title":"\u522a\u9664 JSONB \u8cc7\u6599","description":"PostgreSQL JSONB \u6b04\u4f4d\u9375\u503c\u522a\u9664","keywords":["JSONB","PostgreSQL"]},"sidebar":"totem_sidebar","previous":{"title":"\u65b0\u589e\u4fee\u6539 JSONB \u6b04\u4f4d\u503c","permalink":"/docs/PostgreSQL/JSONB/PostgreSQL_Update_JSONB_Column"},"next":{"title":"\u67e5\u8a62 JSONB \u6b04\u4f4d\u503c","permalink":"/docs/PostgreSQL/JSONB/Postgresql_find_value_by_Attr_of_JSONB_column"}}');var i=s(74848),t=s(28453);const l={title:"\u522a\u9664 JSONB \u8cc7\u6599",description:"PostgreSQL JSONB \u6b04\u4f4d\u9375\u503c\u522a\u9664",keywords:["JSONB","PostgreSQL"]},c=void 0,o={},d=[{value:"Jsonb \u5c6c\u6027\u522a\u9664\u64cd\u4f5c\u5b50 <code><strong>#-</strong></code>",id:"jsonb-\u5c6c\u6027\u522a\u9664\u64cd\u4f5c\u5b50--",level:2},{value:"\u8a9e\u6cd5",id:"\u8a9e\u6cd5",level:3},{value:"example : <code><strong>#-</strong></code>",id:"example---",level:3},{value:"example : <code><strong>jsonb_set</strong></code>",id:"example--jsonb_set",level:3},{value:"Jsonb \u522a\u9664\u8cc7\u6599\u8a9e\u6cd5\u8b8a\u9ad4: <code><strong>-</strong></code>",id:"jsonb-\u522a\u9664\u8cc7\u6599\u8a9e\u6cd5\u8b8a\u9ad4--",level:3}];function a(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{backgroundColor:"#ffffb3"},children:(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:[(0,i.jsx)(n.a,{href:"./PostgreSQL_Jsonb_misc#Jsonb_fundamental",children:"jsonb_set()"})," \u53ef\u7528\u5728\uff0c\u65b0\u589e\u3001\u4fee\u6539\u3001\u522a\u9664"]}),(0,i.jsx)(n.br,{}),"\n","\u6700\u7c21\u55ae\u7684\u8cc7\u6599\u79fb\u9664\u65b9\u5f0f\u70ba\uff0c\u76f4\u63a5\u5c07\u8cc7\u6599\u8a2d\u70ba null \u6216\u7a7a\u5b57\u4e32\u3002"]})}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["\u540c\u6a23\u7684 PostgreSQL Jsonb \u64cd\u4f5c\u90fd\u53ef\u6709\u5169\u7a2e\u4ee5\u4e0a\u9078\u64c7\uff0c",(0,i.jsx)(n.br,{}),"\n","\u2003 1.\u4f7f\u7528\u64cd\u4f5c\u5b50: ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"#-"})}),(0,i.jsx)(n.br,{}),"\n","\u2003 2.\u4f7f\u7528\u51fd\u6578\u8655\u7406: ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"jsonb_set()"})}),(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"#-"})})," \u64cd\u4f5c\u5b50\u53ef\u7528\u4f86\u79fb\u9664 Json \u5c6c\u6027\u503c\u6216\u79fb\u9664\u6574\u500b key-value pair",(0,i.jsx)(n.br,{}),"\n","\u82e5\u50c5\u8981\u79fb\u9664 value \u4e0d\u79fb\u9664 key \u4e5f\u53ef\u4f7f\u7528 ",(0,i.jsx)(n.a,{href:"./PostgreSQL_Update_JSONB_Column",children:"jsonb_set"})," function"]}),"\n"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5efa\u8b70\u9078\u7528 ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"jsonb_set()"})}),"\uff0c",(0,i.jsx)(n.a,{href:"./PostgreSQL_Jsonb_misc#Jsonb_fundamental",children:"\u56e0\u70ba\u8f03\u901a\u7528"}),"\u6e1b\u5c11\u8166\u5b50\u8ca0\u64d4\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"jsonb-\u5c6c\u6027\u522a\u9664\u64cd\u4f5c\u5b50--",children:["Jsonb \u5c6c\u6027\u522a\u9664\u64cd\u4f5c\u5b50 ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"#-"})})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./PostgreSQL_Jsonb_misc",children:"\u7bc4\u4f8b\u8cc7\u6599\u9810\u8a2d\u60c5\u5883"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5047\u8a2d\u6709\u4e00\u500b\u7d00\u9304\u6a19\u672c\u8cc7\u8a0a table \uff0c\u5176\u4e2d\u4ee5 json_data \u7528\u4f86\u8a18\u9304\u5206\u985e\u6a39\u8cc7\u6599 (\u754c\u9580\u7db1\u76ee\u79d1\u5c6c\u7a2e)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u8a9e\u6cd5",children:"\u8a9e\u6cd5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["SET data = data ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"#-"})})," ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"Array[ 'path_parent', 'child', 'descendent' ]"})})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"-- Path \u9700\u4f7f\u7528 Array \u5275\u5efa array \u7269\u4ef6\r\n    UPDATE your_table\r\n        SET data = data #- Array['path_parent', 'child', 'descendent']\r\n        WHERE condition;\r\n\r\n-- \u8207 jsonb_set() \u4e00\u6a23\uff0cpath \u53ef\u4ee5\u4ee5\u5927\u62ec\u865f\u7269\u4ef6\u65b9\u5f0f\u5217\u51fa\r\n    UPDATE your_table\r\n        SET data = data #- '{path_parent, child, descendent}'\r\n        WHERE condition;\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"example---",children:["example : ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"#-"})})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:'    select (insect.classification) classification from insect_specimen insect where id = 2\r\n    ===original\r\n    "{"Class": "Insecta", "Genus": {"name": "Aedes", "Subgenus": {"name": {"value": "Stegomyia-2"}}}, "Order": "Diptera", "Family": "Culicidae", "Phylum": "Arthropoda", "Kingdom": "Animalia", "Species": "albopictus"}"\r\n    \r\n    update insect_specimen SET classification = classification #- array[\'Order\'] where id = 2; \r\n    -- update insect_specimen SET classification = classification #- \'{Order}\' where id = 2; \r\n    ===\r\n    "{"Class": "Insecta", "Genus": {"name": "Aedes", "Subgenus": {"name": {"value": "Stegomyia-2"}}}, "Family": "Culicidae", "Phylum": "Arthropoda", "Kingdom": "Animalia", "Species": "albopictus"}"\r\n    \r\n    -- \u8cc7\u6599\u88dc\u56de\r\n    -- update insect_specimen SET classification = jsonb_set( classification, Array[\'Order\'], \'"Diptera"\'::jsonb ) where id = 2;  \n'})}),"\n",(0,i.jsxs)(n.h3,{id:"example--jsonb_set",children:["example : ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"jsonb_set"})})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./PostgreSQL_Update_JSONB_Column",children:"jsonb_set(raw, path, new_value)"})," function","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"'null'::jsonb"})}),"\uff0cnull \u5916\u5305\u7684 single quote \u4ee3\u8868\u7684\u662f\u8a9e\u6cd5\u4e2d arg \u5fc5\u9808\u662f\u5b57\u4e32\u3002\u6b64\u4f8b\u662f ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"\u6e05\u9664"})})," \u5167\u5bb9\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"'\"\"'::jsonb"})}),"\uff0c\u9019\u500b\u7bc4\u4f8b\u6307\u7684\u662f\u5c07\u820a\u503c\u4ee5  ",(0,i.jsx)(n.em,{children:(0,i.jsx)(n.strong,{children:"\u7a7a\u5b57\u4e32"})})," \u53d6\u4ee3\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"'123'::jsonb"})}),"\uff0c\u5e36\u5165\u6578\u503c"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"    update insect_specimen SET classification = jsonb_set(classification, array['Order'], 'null'::jsonb) where id = 2; \n"})}),"\n",(0,i.jsxs)(n.h3,{id:"jsonb-\u522a\u9664\u8cc7\u6599\u8a9e\u6cd5\u8b8a\u9ad4--",children:["Jsonb \u522a\u9664\u8cc7\u6599\u8a9e\u6cd5\u8b8a\u9ad4: ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"-"})})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u770b\u5f97\u61c2\u5c31\u597d\uff0c\u518d\u591a\u4f86\u8a18\u500b\u540c\u529f\u80fd\u8a9e\u6cd5\u8b8a\u9ad4\u8166\u5b50\u5c31\u8981\u70b8\u4e86..."}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"#-"})})," \u53ef\u4ee5\u63a1\u7528 path TEXT[], \u4f46 ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"-"})})," \u53ea\u80fd\u6307\u5411\u55ae\u4e00\u5c64\u3002","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5b98\u65b9\u6587\u4ef6\u8aaa\u9019\u5169\u500b\u5dee\u5225\uff0c\u4e00\u500b delete key/value pair, \u53e6\u4e00\u500b delete field! \u610f\u601d\u4e0d\u662f\u76f8\u540c\u55ce?"}),"\n",(0,i.jsxs)(n.li,{children:["\u6e2c\u8a66\u7d50\u679c: ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"-"})})," \u53ea\u80fd\u79fb\u9664 ",(0,i.jsxs)("span",{style:{color:"#0044FF"},children:[" ",(0,i.jsx)(n.strong,{children:"\u9802\u5c64 jsonb \u7269\u4ef6\u7684\u6b21\u4e00\u5c64"})," "]})," \u8cc7\u6599\uff0c\u6240\u4ee5\u6b64\u7b26\u865f\u4e0d\u50cf ",(0,i.jsx)("code",{children:(0,i.jsx)(n.strong,{children:"->>"})})," \u53ef\u4e32\u63a5\u524d\u65b9\u8def\u5f91\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sql",children:"    -- '-' \u53ea\u80fd\u7528\u65bc\u9802\u5c64 jsonb \u7d50\u69cb\r\n    update insect_specimen SET classification = classification - 'Order' where id = 2; \r\n    \r\n    -- '->>' \u524d\u65b9\u4e32\u63a5 '->'\r\n    select  classification -> 'Genus' -> 'Subgenus' -> 'name' ->> 'value'  from insect_specimen where id = 3\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}}}]);