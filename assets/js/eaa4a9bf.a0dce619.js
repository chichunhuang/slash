"use strict";(self.webpackChunkinsect_totem=self.webpackChunkinsect_totem||[]).push([[9348],{28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var o=t(96540);const i={},s=o.createContext(i);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:n},e.children)}},30970:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"Tomcat/Tomcat_Httponly","title":"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a","description":"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a- HttpOnly/Secure/SameSite","source":"@site/docs/170_Tomcat/Tomcat_Httponly.md","sourceDirName":"170_Tomcat","slug":"/Tomcat/Tomcat_Httponly","permalink":"/docs/Tomcat/Tomcat_Httponly","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a","description":"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a- HttpOnly/Secure/SameSite","keywords":["Tomcat","Cookie","HttpOnly","Secure","SameSite"]},"sidebar":"totem_sidebar","previous":{"title":"Tomcat \u5ba2\u88fd\u932f\u8aa4\u9801","permalink":"/docs/Tomcat/Tomcat_Error_Page"},"next":{"title":"Tomcat https \u8a2d\u5b9a","permalink":"/docs/Tomcat/Tomcat_Https_Private"}}');var i=t(74848),s=t(28453);const r={title:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a",description:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a- HttpOnly/Secure/SameSite",keywords:["Tomcat","Cookie","HttpOnly","Secure","SameSite"]},c="Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a",l={},a=[{value:"\u6e2c\u8a66\u74b0\u5883",id:"\u6e2c\u8a66\u74b0\u5883",level:2},{value:"Tomcat \u4e2d\u8207 JSESSIONID/Cookie \u76f8\u95dc\u5168\u6027\u8a2d\u5b9a",id:"tomcat-\u4e2d\u8207-jsessionidcookie-\u76f8\u95dc\u5168\u6027\u8a2d\u5b9a",level:2},{value:"HttpOnly \u7528\u9014 <span></span>",id:"httponly-\u7528\u9014-",level:2},{value:"SameSite \u7528\u9014 <span></span>",id:"samesite-\u7528\u9014-",level:2},{value:"Tomcat JSESSIONID HttpOnly \u8a2d\u5b9a\u65b9\u5f0f",id:"tomcat-jsessionid-httponly-\u8a2d\u5b9a\u65b9\u5f0f",level:2},{value:"\u6aa2\u67e5\u8a2d\u5b9a\u662f\u5426\u751f\u6548",id:"\u6aa2\u67e5\u8a2d\u5b9a\u662f\u5426\u751f\u6548",level:2},{value:"\u5176\u4ed6",id:"\u5176\u4ed6",level:2},{value:"\u53c3\u8003\u8cc7\u6599",id:"\u53c3\u8003\u8cc7\u6599",level:3},{value:"JQuery Cookie \u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f",id:"jquery-cookie-\u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f",level:3},{value:"wicket Framework \u4e2d\u8a2d\u5b9a\u65b9\u5f0f",id:"wicket-framework-\u4e2d\u8a2d\u5b9a\u65b9\u5f0f",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"tomcat-cookie-\u5b89\u5168\u6027\u8a2d\u5b9a",children:"Tomcat Cookie \u5b89\u5168\u6027\u8a2d\u5b9a"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6e2c\u8a66\u74b0\u5883",children:"\u6e2c\u8a66\u74b0\u5883"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53d7\u7a3d\u6838\u7684\u820a\u7cfb\u7d71"}),"\n",(0,i.jsx)(n.li,{children:"Tomcat8.5"}),"\n",(0,i.jsx)(n.li,{children:"JDK8"}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"cookie-\u53ef\u5206\u70ba",children:"COOKIE \u53ef\u5206\u70ba"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"SESSION COOKIE ie JSESSIONID: \u7531 Tomcat Container \u6240\u7522\u751f\u8207\u7ba1\u7406\u3002"}),"\n",(0,i.jsx)(n.li,{children:"Customized Cookie : \u9019\u908a\u6cdb\u6307\u958b\u767c\u6642\u81ea\u884c\u5efa\u7acb\u8207\u7dad\u8b77\u7684\u90e8\u5206\u3002"}),"\n",(0,i.jsx)(n.li,{children:"3rd Cookie : \u5176\u4ed6 Libs \u6240\u5efa\u7acb\u8207\u4f7f\u7528\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"tomcat-\u4e2d\u8207-jsessionidcookie-\u76f8\u95dc\u5168\u6027\u8a2d\u5b9a",children:"Tomcat \u4e2d\u8207 JSESSIONID/Cookie \u76f8\u95dc\u5168\u6027\u8a2d\u5b9a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u4e3b\u8981\u6703\u8a0e\u8ad6\u5230\u4e0b\u5217\u4e09\u9805","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#HttpOnly-id",children:"HttpOnly"})," : \u9650\u5236 Cookie \u50c5\u80fd\u7d93\u7531 Http(s) Protocol \u5b58\u53d6\u3002\u6240\u4ee5\u5176\u4ed6  JavaScript \u7121\u6cd5\u5b58\u53d6\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#Secure-id",children:"Secure"})," : Cookie \u50c5\u80fd\u5728\u52a0\u5bc6\u7684\u9023\u4e0b\u60c5\u5883\u4e0b\u4f7f\u7528\u3002\u4e5f\u5c31\u662f\u53c8\u518d\u4f9d\u7e2e\u9650\u5236\u53ea\u80fd\u5728 Https \u4e2d\u4f7f\u7528\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#SameSite-id",children:"SameSite"})," : \u540c\u6e90\uff0cCookie \u4e0d\u80fd\u8de8\u7db2\u7ad9\u5206\u4eab\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"httponly-\u7528\u9014-",children:["HttpOnly \u7528\u9014 ",(0,i.jsx)("span",{id:"HttpOnly-id"})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Tomcat \u8a2d\u5b9a Cookie \u70ba HttpOnly \u6642\u610f\u5473\u8457\uff0cCookie \u50c5\u80fd\u7d93\u7531 http/https \u5b58\u53d6\uff0c\u5176\u4ed6 Script \u4e00\u5f8b\u7981\u6b62\u5b58\u53d6\u3002",(0,i.jsx)("br",{}),"\r\n\u7c21\u55ae\u7684\u8aaa\u6cd5\u662f\u700f\u89bd\u5668\u53ef",(0,i.jsx)("span",{style:{color:"#0044FF"},children:"\u62d2\u7d55\u8207\u4ed6\u4eba\u5982 JsvaScript \u5171\u4eab Cookies"}),"\u3002",(0,i.jsx)("br",{}),"\r\n\u70ba\u4f55\u91cd\u8981 Cookie \u4e0d\u8a72\u5171\u4eab? \u8209\u4f8b\u4f86\u8aaa: \u5e38\u898b\u7684 cookie JSESSIONID \u82e5\u88ab\u7aca\u53d6\uff0c\u901a\u5e38\u9020\u6210 SESSION \u8207\u8eab\u5206\u88ab\u76dc\u7528\uff0c\r\n\u4e5f\u5c31\u662f\u8aaa HttpOnly \u4e3b\u8981\u76ee\u7684\u5728\u65bc\u9632\u6b62 ",(0,i.jsx)(n.a,{href:"https://owasp.org/www-community/attacks/xss/",children:"XSS(Cross Site Scripting)"})," \u653b\u64ca\u3002",(0,i.jsx)("br",{})]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h1,{id:"secure-\u7528\u9014-",children:["Secure \u7528\u9014 ",(0,i.jsx)("span",{id:"Secure-id"})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Secure \u8a2d\u70ba true \u610f\u5473\u8457 Cookie \u50c5\u80fd\u5728\u52a0\u5bc6\u7684\u7ba1\u9053\u4f7f\u7528\u3002\r\n\u8209\u4f8b\u4f86\u8aaa\uff0c\u964d\u4f4e\u98a8\u96aa\u7684\u6a5f\u5236\u70ba\u7576\u4e00\u500b https \u7db2\u7ad9\u82e5\u88ab\u5d4c\u5728 http \u7684\u91e3\u9b5a\u7db2\u7ad9\u5167\u6642\u3002\u56e0\u70ba Cookie \u88ab\u9650\u5236\u53ea\u80fd\u5728 https \u4e4b\u4e0b\u4f7f\u7528\u3002\r\n\u6240\u4ee5\u91e3\u9b5a\u7db2\u7ad9\u90e8\u5206\u529f\u80fd\u6703\u5931\u6548\u3002\u82e5\u662f\u8a72 Cookie \u70ba Session Cookie (\u5982: JSESSIONID)\u5247\u6703\u81ea\u52d5\u88ab\u767b\u51fa\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"samesite-\u7528\u9014-",children:["SameSite \u7528\u9014 ",(0,i.jsx)("span",{id:"SameSite-id"})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u540c\u6e90\uff0c\u9019\u908a\u89e3\u91cb\u5c31\u66f4\u5bb9\u6613\u7406\u89e3\u4e86\u3002Cookie \u7121\u6cd5\u8de8 Domain \u4f7f\u7528\u3002\u6240\u4ee5\u7576\u7db2\u7ad9\u88ab\u5167\u5d4c\u6642\uff0c\r\n\u7531\u65bc\u91e3\u9b5a\u7db2\u7ad9\u7684\u7db2\u5740 Domain \u662f\u507d\u9020\u7684\u4e00\u5b9a\u8207\u539f\u59cb\u7db2\u7ad9\u4e0d\u540c\u3002\u56e0\u6b64\u7121\u6cd5\u53d6\u7528 Cookies\u3002"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\u5ef6\u4f38\u95b1\u8b80 Line of Death"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"tomcat-jsessionid-httponly-\u8a2d\u5b9a\u65b9\u5f0f",children:"Tomcat JSESSIONID HttpOnly \u8a2d\u5b9a\u65b9\u5f0f"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Tomcat7+ \u4e4b\u5f8c JSESSIONID \u7684 ",(0,i.jsx)("span",{style:{color:"#0044FF"},children:"HttpOnly \u5c6c\u6027\u9810\u8a2d\u70ba true"}),"\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Tomcat7+ \u986f\u5f0f HttpOnly \u8a2d\u5b9a\u65b9\u5f0f\u9700\u540c\u6642\u8a2d\u5b9a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"web.xml : cookie-config > http-only = true"}),"\n",(0,i.jsx)(n.li,{children:"web.xml : cookie-config > secure = true"}),"\n",(0,i.jsx)(n.li,{children:"server.xml : connector > secure = true"}),"\n",(0,i.jsx)(n.li,{children:"context.xml : CookieProcessor > sameSiteCookies = strict"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"web.xml"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"    <session-config>\r\n         <tracking-mode>COOKIE</tracking-mode>\r\n         <cookie-config>\r\n            <http-only>true</http-only>\r\n            <secure>true</secure>\r\n         </cookie-config>\r\n    </session-config>\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"server.xml"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'        <Connector port="8080" protocol="HTTP/1.1"\r\n               connectionTimeout="20000"\r\n               redirectPort="8443" URIEncoding="UTF-8" secure="true"/>\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"context.xml"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<Context>\r\n    <CookieProcessor className="org.apache.tomcat.util.http.LegacyCookieProcessor" sameSiteCookies="strict" />      \r\n</Context>  \n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6aa2\u67e5\u8a2d\u5b9a\u662f\u5426\u751f\u6548",children:"\u6aa2\u67e5\u8a2d\u5b9a\u662f\u5426\u751f\u6548"}),"\n",(0,i.jsx)(n.p,{children:"Chrome developer tool (F12) > Application > Storage Cookies"}),"\n",(0,i.jsx)(n.h2,{id:"\u5176\u4ed6",children:"\u5176\u4ed6"}),"\n",(0,i.jsx)(n.h3,{id:"\u53c3\u8003\u8cc7\u6599",children:"\u53c3\u8003\u8cc7\u6599"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://blog.51cto.com/u_9597987/3485720",children:"HttpOnly \u7c21\u4ecb"})}),"\n",(0,i.jsxs)(n.li,{children:["\u9632\u79a6 Cross-Site Scripting (XSS) ",(0,i.jsx)(n.a,{href:"https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/",children:"Content-Security-Pilicy"})]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://devco.re/blog/2014/06/03/http-session-protection/",children:"HTTP Session \u653b\u64ca\u8207\u9632\u8b77"})}),"\n",(0,i.jsxs)(n.li,{children:["HttpOnly ",(0,i.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc6265",children:"RFC 6265"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"jquery-cookie-\u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f",children:"JQuery Cookie \u5efa\u7acb\u8207\u8a2d\u5b9a\u65b9\u5f0f"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.runoob.com/jquery/jquery-cookie-plugin.html",children:"https://www.runoob.com/jquery/jquery-cookie-plugin.html"})}),"\n",(0,i.jsx)(n.li,{children:"jquery is js: \u6240\u4ee5\u7121\u6cd5\u7ba1\u7406\u8207\u8a2d\u5b9a\u8d85\u51fa\u81ea\u5df1\u6b0a\u9650\u7bc4\u570d\u7684 httponly \u5c6c\u6027"}),"\n",(0,i.jsx)(n.li,{children:"\u6709\u4eba\u628a sameSite: 'strict' \u85cf\u5728 path \u5c6c\u6027\u4e4b\u4e2d\u3002\u5be6\u969b\u6e2c\u8a66\u53ef\u884c\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'tricky 1: \u653e\u5728 path\r\ntricky 2: \u5b57\u9996\u5927\u5beb\r\n\r\n$.cookie("testCookieName", "TestValue Name",{ expires : 30, path: "/;SameSite=strict"});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"wicket-framework-\u4e2d\u8a2d\u5b9a\u65b9\u5f0f",children:"wicket Framework \u4e2d\u8a2d\u5b9a\u65b9\u5f0f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Javascript",children:'        WebResponse webResponse = (WebResponse) RequestCycle.get()\r\n                .getResponse();\r\n        Cookie cookie = new Cookie("showLeftColumn", "");\r\n        cookie.setPath("/");\r\n        cookie.setHttpOnly(true);\r\n        cookie.setSecure(true);\r\n        webResponse.addCookie(cookie);\n'})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);