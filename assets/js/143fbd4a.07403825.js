"use strict";(self.webpackChunktool=self.webpackChunktool||[]).push([[9892],{2074:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>p,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>y});const t=JSON.parse('{"id":"Java/Cypher/Java_KeyPairGenerator","title":"KeyPairGenerator \u516c\u79c1\u9470","description":"Java KeyPairGenerator \u57fa\u672c\u4f7f\u7528\u65b9\u5f0f","source":"@site/docs/Java/Cypher/Java_KeyPairGenerator.md","sourceDirName":"Java/Cypher","slug":"/Java/Cypher/Java_KeyPairGenerator","permalink":"/docs/Java/Cypher/Java_KeyPairGenerator","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"KeyPairGenerator \u516c\u79c1\u9470","description":"Java KeyPairGenerator \u57fa\u672c\u4f7f\u7528\u65b9\u5f0f","keywords":["java","cipher","KeyPairGenerator"]},"sidebar":"totem_sidebar","previous":{"title":"Java Cipher Intro","permalink":"/docs/Java/Cypher/Java_Encryption"},"next":{"title":"Java PBE \u52a0\u89e3\u5bc6","permalink":"/docs/Java/Cypher/Java_Pbe_Cipher"}}');var i=n(4848),a=n(8453);const o={title:"KeyPairGenerator \u516c\u79c1\u9470",description:"Java KeyPairGenerator \u57fa\u672c\u4f7f\u7528\u65b9\u5f0f",keywords:["java","cipher","KeyPairGenerator"]},p=void 0,c={},y=[{value:"KeyPairGenerator API \u7c21\u4ecb",id:"keypairgenerator-api-\u7c21\u4ecb",level:2},{value:"KeyPairGenerator \u7bc4\u4f8b",id:"keypairgenerator-\u7bc4\u4f8b",level:2},{value:"\u9664\u932f",id:"\u9664\u932f",level:2},{value:"BadPaddingException",id:"badpaddingexception",level:3}];function s(e){const r={code:"code",h2:"h2",h3:"h3",li:"li",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h2,{id:"keypairgenerator-api-\u7c21\u4ecb",children:"KeyPairGenerator API \u7c21\u4ecb"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-java",children:'import java.security.KeyPairGenerator;\r\n\r\n...\r\n\r\nKeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");\r\n \r\n//\u521d\u59cb\u5316,\u8a2d\u5b9a\u9577\u5ea6\u70ba1024\r\nkeyGen.initialize(1024);\r\n \r\n//\u7522\u751fkey pair\r\nKeyPair key = keyGen.generateKeyPair();\r\n \r\n//\u7522\u751fciper\r\nCipher cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");\r\n \r\n//\u6e96\u5099\u4ee5\u516c\u9470\u9032\u884c\u52a0\u5bc6\r\ncipher.init(Cipher.ENCRYPT_MODE, key.getPublic());\r\n \r\n//\u53d6\u5f97\u4ee5\u516c\u9470\u52a0\u5bc6\u5f8c\u7684ciphertext\r\nbyte[] cipherText = cipher.doFinal("\u6e2c\u8a66123".getBytes());\r\nSystem.out.println("Finish encryption:");\r\n \r\n//\u6e96\u5099\u4ee5\u79c1\u9470\u9032\u884c\u89e3\u5bc6\r\ncipher.init(Cipher.DECRYPT_MODE,key.getPrivate());\r\n \r\n//\u53d6\u5f97\u4ee5\u79c1\u9470\u89e3\u5bc6\u5f8c\u7684plaintext\r\nbyte[] newPlainText=cipher.doFinal(cipherText);\r\nSystem.out.println(new String(newPlainText,"UTF8"));\r\n \r\n//\u6e96\u5099\u4ee5\u79c1\u9470\u9032\u884c\u52a0\u5bc6\r\ncipher.init(Cipher.ENCRYPT_MODE, key.getPrivate());\r\ncipherText = cipher.doFinal("\u6e2c\u8a66123".getBytes());\r\nSystem.out.println("Finish encryption:");\r\n \r\n//\u6e96\u5099\u4ee5\u516c\u9470\u9032\u884c\u89e3\u5bc6\r\ncipher.init(Cipher.DECRYPT_MODE,key.getPublic());\r\nnewPlainText=cipher.doFinal(cipherText);\r\nSystem.out.println(new String(newPlainText,"UTF8"));\r\n\n'})}),"\n",(0,i.jsx)(r.h2,{id:"keypairgenerator-\u7bc4\u4f8b",children:"KeyPairGenerator \u7bc4\u4f8b"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:'import java.security.InvalidKeyException;\r\nimport java.security.Key;\r\nimport java.security.KeyPair;\r\nimport java.security.KeyPairGenerator;\r\nimport java.security.MessageDigest;\r\nimport java.security.NoSuchAlgorithmException;\r\nimport java.security.PublicKey;\r\n\r\nimport javax.crypto.Cipher;\r\nimport javax.crypto.KeyGenerator;\r\nimport javax.crypto.NoSuchPaddingException;\r\n\r\npublic class TestCipher {\r\n\r\n    public static void main(String[] args) throws Exception {\r\n//      doDigest();\r\n//      doPrivacyKeyEncryption();\r\n        doPublicKeyEncryption();\r\n    }\r\n\r\n    public static void doPublicKeyEncryption() throws Exception {\r\n        KeyPairGenerator keyGen = KeyPairGenerator.getInstance("RSA");\r\n        keyGen.initialize(2048);\r\n        KeyPair key = keyGen.generateKeyPair();\r\n\r\n        Cipher cipher = Cipher.getInstance("RSA/ECB/PKCS1Padding");\r\n\r\n        PublicKey pk = key.getPublic();\r\n        System.out.println(convertKeyBytes(pk.getEncoded()));;\r\n        cipher.init(Cipher.ENCRYPT_MODE, pk);\r\n        byte[] cipherText = cipher.doFinal("\u4e2d\u6587\u6e2c\u8a66\u8a31\u529f\u84cb123".getBytes());\r\n        System.out.println("\u4ee5\u516c\u9470\u52a0\u5bc6\u5b8c\u6210.");\r\n        \r\n        cipher.init(Cipher.DECRYPT_MODE,key.getPrivate());\r\n        byte[] newPlainText=cipher.doFinal(cipherText);\r\n        System.out.printf("\u4ee5\u79c1\u9470\u89e3\u5bc6:%s\\n", new String(newPlainText,"UTF8"));\r\n        \r\n        cipher.init(Cipher.ENCRYPT_MODE, key.getPrivate());\r\n        cipherText = cipher.doFinal("\u4e2d\u6587\u6e2c\u8a66\u8a31\u529f\u84cb123".getBytes());\r\n        System.out.println("\u4ee5\u79c1\u9470\u52a0\u5bc6\u5b8c\u6210.");\r\n        \r\n        cipher.init(Cipher.DECRYPT_MODE,pk);\r\n        newPlainText=cipher.doFinal(cipherText);\r\n        System.out.printf("\u4ee5\u516c\u9470\u89e3\u5bc6:%s\\n", new String(newPlainText,"UTF8"));\r\n    }\r\n\r\n    public static void doPrivacyKeyEncryption() throws Exception {\r\n        System.out.println("\\nStart generate AES key");\r\n        Key key = createKey("AES", 128);\r\n\r\n        Cipher cipher = createCipher(key, Cipher.ENCRYPT_MODE,\r\n                "AES/ECB/PKCS5Padding");\r\n        cipher.init(Cipher.ENCRYPT_MODE, key);\r\n\r\n        byte[] cipherText = cipher.doFinal("\u6e2c\u8a66123".getBytes());\r\n\r\n        System.out.println("Finish encryption:");\r\n        System.out.println(new String(cipherText, "UTF8"));\r\n\r\n        cipher.init(Cipher.DECRYPT_MODE, key);\r\n        byte[] newPlainText = cipher.doFinal(cipherText);\r\n\r\n        System.out.println("Finish decryption:");\r\n        System.out.println(new String(newPlainText, "UTF8"));\r\n    }\r\n\r\n    private static Cipher createCipher(Key key, int cipherMode,\r\n            String cipherType) throws NoSuchAlgorithmException,\r\n            NoSuchPaddingException, InvalidKeyException {\r\n        Cipher cipher = Cipher.getInstance(cipherType);\r\n        return cipher;\r\n    }\r\n\r\n    private static Key createKey(String keyGenType, int keyLength)\r\n            throws NoSuchAlgorithmException {\r\n        KeyGenerator keyGen = KeyGenerator.getInstance(keyGenType);\r\n        keyGen.init(keyLength);\r\n        Key key = keyGen.generateKey();\r\n        return key;\r\n    }\r\n\r\n    public static void doDigest() throws Exception {\r\n        MessageDigest md = MessageDigest.getInstance("sha-512");\r\n        System.out.println(md.getProvider().getInfo());\r\n        md.update("12345".getBytes());\r\n        byte[] bytes = md.digest();\r\n        System.out.println(bytes);\r\n        String strBuf = convertKeyBytes(bytes);\r\n        \r\n        System.out.println(strBuf);\r\n        System.out.println(strBuf.length());\r\n    }\r\n\r\n    private static String convertKeyBytes(byte[] bytes) {\r\n        StringBuffer strBuf = new StringBuffer();\r\n        \r\n        for(byte b : bytes) {\r\n            strBuf.append(String.format("%02x", b));\r\n        }\r\n        return strBuf.toString();\r\n    }\r\n}\r\n\n'})}),"\n",(0,i.jsx)(r.h2,{id:"\u9664\u932f",children:"\u9664\u932f"}),"\n",(0,i.jsx)(r.h3,{id:"badpaddingexception",children:"BadPaddingException"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"\u53ef\u80fd\u767c\u751f\u539f\u56e0: Public key\u548csecret key\u4e0d\u662f\u4e00\u8d77\u7522\u751f\u51fa\u4f86(\u4e0d\u5c6c\u65bc\u540c\u4e00\u500bkey pair), \u7576\u7528\u65bc\u52a0\u89e3\u5bc6\u6642\u6703\u51fa\u73fe BadPaddingException"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"javax.crypto.BadPaddingException: Data must start with zero\n"})})]})}function h(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(s,{...e})}):s(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>p});var t=n(6540);const i={},a=t.createContext(i);function o(e){const r=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function p(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:r},e.children)}}}]);