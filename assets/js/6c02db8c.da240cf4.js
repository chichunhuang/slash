"use strict";(globalThis.webpackChunkinsect_totem=globalThis.webpackChunkinsect_totem||[]).push([[7317],{24800:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Java/Session_Fixation_Wicket","title":"\u975e\u6b63\u898fSession Fixation\u8655\u7406","description":"\u964d\u4f4e\u98a8\u96aa\uff0c\u4e26\u672a\u5b8c\u5168\u5373\u6642","source":"@site/docs/110_Java/Session_Fixation_Wicket.md","sourceDirName":"110_Java","slug":"/Java/Session_Fixation_Wicket","permalink":"/docs/Java/Session_Fixation_Wicket","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u975e\u6b63\u898fSession Fixation\u8655\u7406","description":"\u964d\u4f4e\u98a8\u96aa\uff0c\u4e26\u672a\u5b8c\u5168\u5373\u6642","keywords":["Session Fixation","Wicket"]},"sidebar":"totem_sidebar","previous":{"title":"Session Fixation","permalink":"/docs/Java/Session_Fixation"},"next":{"title":"\u95dc\u9589 Browser or Tab \u81ea\u52d5\u767b\u51fa","permalink":"/docs/Java/Web_Auto_Logout"}}');var r=s(74848),t=s(28453);const o={title:"\u975e\u6b63\u898fSession Fixation\u8655\u7406",description:"\u964d\u4f4e\u98a8\u96aa\uff0c\u4e26\u672a\u5b8c\u5168\u5373\u6642",keywords:["Session Fixation","Wicket"]},l="Session Fixation \u7684[\u975e\u6b63\u898f]\u8655\u7406\u65b9\u5f0f",a={},c=[{value:"\u5f37\u884c\u66f4\u63db JSESSIONID",id:"\u5f37\u884c\u66f4\u63db-jsessionid",level:2},{value:"\u96e2\u958b\u9801\u9762\u6642\uff0c\u6bba\u6b7b\u7576\u524d SESSION\u3002",id:"\u96e2\u958b\u9801\u9762\u6642\u6bba\u6b7b\u7576\u524d-session",level:2},{value:"\u7e2e\u77ed Session key \u7684\u6548\u671f",id:"\u7e2e\u77ed-session-key-\u7684\u6548\u671f",level:2},{value:"JSESSIONID \u507d\u88dd",id:"jsessionid-\u507d\u88dd",level:2},{value:"web.xml Session Time \u8a2d\u5b9a",id:"webxml-session-time-\u8a2d\u5b9a",level:2},{value:"Java code \u8a2d\u5b9a MaxInactiveInterval",id:"java-code-\u8a2d\u5b9a-maxinactiveinterval",level:2},{value:"\u5176\u4ed6: \u700f\u89bd\u5668\u63d0\u9192:",id:"\u5176\u4ed6-\u700f\u89bd\u5668\u63d0\u9192",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"session-fixation-\u7684\u975e\u6b63\u898f\u8655\u7406\u65b9\u5f0f",children:"Session Fixation \u7684[\u975e\u6b63\u898f]\u8655\u7406\u65b9\u5f0f"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u975e\u6b63\u898f: \u56e0\u70ba\u9084\u662f\u6703\u88ab\u5de5\u5177\u6383\u51fa\u4f86\u3002\u4e0b\u5217\u65b9\u6cd5\u50c5\u662f\u964d\u4f4e\u88ab\u99ed\u7684\u6a5f\u6703\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["\u8abf\u6574\u6982\u5ff5:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5f37\u884c\u66f4\u63db JSESSIONID \u503c\uff0c\u7e2e\u77ed ID \u7684\u6548\u671f\u3002\u5c31\u8b93\u4f60\u5077\u5427!\u6211\u983b\u7e41\u66f4\u63db key \u7e3d\u884c\u4e86\u5427"}),"\n",(0,r.jsx)(n.li,{children:"\u96e2\u958b\u9801\u9762\u6642\uff0c\u6bba\u6b7b\u7576\u524d SESSION"}),"\n",(0,r.jsx)(n.li,{children:"Container \u7e2e\u77ed Session Timeout \u6642\u9593"}),"\n",(0,r.jsx)(n.li,{children:"JSESSIONID \u507d\u88dd"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Session Timeout"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5f37\u884c\u66f4\u63db-jsessionid",children:"\u5f37\u884c\u66f4\u63db JSESSIONID"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u4ee5 Wicket Framework \u70ba\u7bc4\u4f8b"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\r\nSignInPanel {\r\n  public String signIn(String username, String password) throws AuthenticationException {\r\n        //\u66f4\u63db Session(Session \u9084\u6d3b\u8457), \u5176\u4ed6 cookies \u6703\u4e00\u4f75\u88ab\u6e05\u9664\u3002\r\n\t\tgetBaseSession().replaceSession();\r\n  }\r\n}\r\n\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u96e2\u958b\u9801\u9762\u6642\u6bba\u6b7b\u7576\u524d-session",children:"\u96e2\u958b\u9801\u9762\u6642\uff0c\u6bba\u6b7b\u7576\u524d SESSION\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"invalidete : \u6574\u500b Session \u88ab\u6467\u6bc0"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:' ExternalLink link = new ExternalLink("destSystemUrl",\r\n                            tuple.getSecond());\r\n                    link.add(new AjaxEventBehavior("click") {\r\n\r\n                        @Override\r\n                        protected void onEvent(AjaxRequestTarget target) {\r\n                            // \u66f4\u81f3\u5176\u4ed6\u5916\u90e8\u9801\u9762\u6642\uff0c\u6bba\u6b7b\u7576\u4e0b\u7cfb\u7d71\u7684 Session\r\n                            getSession().invalidate();\r\n                        }\r\n\r\n                        @Override\r\n                        protected void updateAjaxAttributes(\r\n                                AjaxRequestAttributes attributes) {\r\n                            super.updateAjaxAttributes(attributes);\r\n                            // \u56e0\u70ba Ajax \u70ba\u540c\u6b65\u52d5\u4f5c\u70ba\u907f\u514d\u8f49\u5916\u90e8\u9801\u9762\u6642 request \u5c1a\u672a\u52d5\u4f5c\u4fbf\u767b\u51fa\uff0c\u6545\u5ef6\u90721sec,\r\n                            // \u4ee5\u907f\u514d\u7576\u524d Session \u5148 destroy \u800c\u8df3\u5230\u767b\u5165\u9801\r\n                            attributes.setThrottlingSettings(\r\n                                    new ThrottlingSettings(link.getMarkupId(),\r\n                                            Duration.ONE_SECOND, true));\r\n                        }\r\n                    });\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u7e2e\u77ed-session-key-\u7684\u6548\u671f",children:"\u7e2e\u77ed Session key \u7684\u6548\u671f"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\u5728\u4f7f\u7528\u8005\u505a\u52d5\u4f5c\u6642:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"action(on request submit) =>  change Session ID"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.li,{children:"Session \u8207\u539f\u672c\u7684 Cookies \u90fd\u9084\u5728\uff0c\u4f46\u662f Container \u7528\u4f86\u8fa8\u5225 Session \u7684 token \u5df2\u88ab\u66f4\u63db."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\r\n    //Wicket7.x\r\n    ServletWebRequest request = (ServletWebRequest) RequestCycle\r\n                .get().getRequest();\r\n    HttpServletRequest httpRequest = request.getContainerRequest();\r\n    Map params = httpRequest.getParameterMap();\r\n    httpRequest.changeSessionId();\r\n    \t\r\n    //Wicket8.x\r\n    Session session = getSession();\r\n    BaseSession bs = (BaseSession) session;\r\n    session.changeSessionid();\r\n\n"})}),"\n",(0,r.jsx)(n.h2,{id:"jsessionid-\u507d\u88dd",children:"JSESSIONID \u507d\u88dd"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5728\u88ab\u653b\u64ca\u7576\u4e0b\uff0c\u55ae\u7d14\u53ea\u662f\u70ba\u4e86\u722d\u53d6\u6642\u9593\u800c\u5df2......"}),"\n",(0,r.jsx)(n.li,{children:"\u66f4\u6539\u9810\u8a2d Container Session ID \u7684 key : jsessionid"}),"\n",(0,r.jsx)(n.li,{children:"\u507d\u88dd\u4e00\u500b jsessionid \u653e\u5165 cookie\uff0c\u4e0d\u8b8a\u66f4\u503c\u3002\u7528\u4ee5\u6a21\u64ec\u9810\u8a2d Session ID \u52d5\u4f5c\u3002"}),"\n",(0,r.jsxs)(n.li,{children:["\u88fd\u4f5c\u5341\u500b\u5047\u7684\u52d5\u614b\u8b8a\u66f4\u503c\u7684 cookies\uff0c\u5176\u4e2d\u4e00\u500b\u662f\u771f\u6b63\u7684 Session ID","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u642d\u914d tomcat \u66f4\u63db Session ID \u7684 key : fake_session_name"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'//server.xml: \u66f4\u6539 \u9810\u8a2d sessionCookieName \u65b9\u6cd5A\r\n<Context path="/" docBase="webapp" reloadable="false" sessionCookieName="fake_session_name"></Context>\r\n\n'})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'//context.xml:  \u66f4\u6539\u9810\u8a2d sessionCookieName \u65b9\u6cd5B\r\n\r\n<Context sessionCookieName="fake_session_name ">\r\n \r\n    \x3c!-- Default set of monitored resources. If one of these changes, the    --\x3e\r\n    \x3c!-- web application will be reloaded.                                   --\x3e\r\n    <WatchedResource>WEB-INF/web.xml</WatchedResource>\r\n    <WatchedResource>${catalina.base}/conf/web.xml</WatchedResource>\r\n</Context>\r\n\n'})}),"\n",(0,r.jsx)(n.h2,{id:"webxml-session-time-\u8a2d\u5b9a",children:"web.xml Session Time \u8a2d\u5b9a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5728 web.xml \u4e2d\u7684 session-config \u8a2d\u5b9a session-timeout \u5143\u7d20 (unit: mins)"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"    <session-config>\r\n        <session-timeout>30</session-timeout>\r\n    </session-config>\r\n\n"})}),"\n",(0,r.jsx)(n.h2,{id:"java-code-\u8a2d\u5b9a-maxinactiveinterval",children:"Java code \u8a2d\u5b9a MaxInactiveInterval"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u55ae\u4f4d \u79d2"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"    session.setMaxInactiveInterval(30 * 60); \r\n    \n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5176\u4ed6-\u700f\u89bd\u5668\u63d0\u9192",children:"\u5176\u4ed6: \u700f\u89bd\u5668\u63d0\u9192:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u7576\u4f7f\u7528\u8005\u5617\u8a66\u96e2\u958b\u6642\uff0c\u5982\u95dc\u9589 Browser \u6216 Browser tabs \u6642\u7d66\u4e88\u63d0\u9192\u8a0a\u606f\u3002\u8b93\u4f7f\u7528\u8005\u4e3b\u52d5\u767b\u51fa\u907f\u514d Session key \u6b98\u7559\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\u5fc5\u9808\u5728\u7db2\u9801\u4e0a\u6709\u4e92\u52d5\u4e4b\u5f8c\u4e0b\u5217 JS \u624d\u6703\u751f\u6548"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u7576\u4e8b\u4ef6\u8fd4\u56de\u503c\u4e0d\u662f null \u6216\u8005 undefined \u6642\uff0c\u4f7f\u7528\u8005\u5c07\u6703\u88ab\u63d0\u9192\u662f\u5426\u96e2\u958b\u9801\u9762\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Firefox 44+, Chrome 51+, Opera 38+, Safari 9.1+ \u4ee5\u5f8c \u7121\u6cd5\u81ea\u8a02\u63d0\u793a\u6587\u5b57\u3002"}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"\u7db2\u8def\u4e0a\u67e5\u5230\u7684\u9810\u8a2d\u7684\u63d0\u793a\u5167\u5bb9\u5982\u4e0b:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Firefox(66.0.3)\u201c\u6b64\u9801\u9762\u60f3\u8a62\u554f\u60a8\u662f\u5426\u8981\u96e2\u958b - \u60a8\u8f38\u5165\u7684\u8cc7\u6599\u53ef\u80fd\u4e0d\u6703\u88ab\u4fdd\u5b58\u201d"}),"\n",(0,r.jsx)(n.li,{children:"Safari(10.1.2)\u201c\u60a8\u78ba\u5b9a\u8981\u96e2\u958b\u6b64\u9801\u9762\u55ce?"}),"\n",(0,r.jsx)(n.li,{children:"Chrome(74.0.3729.131)\u201c\u91cd\u65b0\u8f09\u5165\u6b64\u7db2\u7ad9?\u201d\u201c\u7cfb\u7d71\u53ef\u80fd\u4e0d\u6703\u4fdd\u5b58\u60a8\u6240\u505a\u7684\u66f4\u6539\u3002"}),"\n",(0,r.jsx)(n.li,{children:"alert, confirm&, prompt\u4e0d\u57f7\u884c"}),"\n",(0,r.jsx)(n.li,{children:"\u5728\u4e00\u4e9b\u6d41\u89bd\u5668\u4e2d,\u5728onbeforeunload\u4e2d\u8abf\u7528alert,confirm,prompt\u7b49\u65b9\u6cd5\u6703\u88ab\u5ffd\u7565\u3002"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"https://www.geeksforgeeks.org/how-to-detect-browser-or-tab-closing-in-javascript/",children:"How to detect browser or tab closing in JavaScript ?"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"window.addEventListener('beforeunload', function (e) {\r\n    e.preventDefault();\r\n    e.returnValue = '';\r\n});\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u7db2\u8def\u4e0a\u7684 e.preventDefault() \u5168\u90e8\u7bc4\u4f8b"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title>\r\n        Detect Browser or Tab Closing Event in JavaScript\r\n    </title>\r\n    <script  language=\"JavaScript\">\r\n      window.addEventListener('beforeunload', function (e) {\r\n            e.preventDefault();\r\n            e.returnValue = '';\r\n        });\r\n    \r\n    \r\n    <\/script>\r\n</head>\r\n<body>\r\n     <h1>\r\n        Detect Browser or Tab Closing Event in JavaScript\r\n    </h1>\r\n    <p>\r\n        The beforeunload event is fired just \r\n        before the closing the tab or browser\r\n        window or reloading the page. \r\n        In modern web browsers, you may have \r\n        to interate with the web\r\n        page to get the confirmation dialog.\r\n    </p>\r\n    <form>\r\n        <textarea placeholder = \"Write few words here to trigger an\r\n        interaction\">\r\n        </textarea>\r\n    </form>\r\n</body>\r\n</html> \n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var i=s(96540);const r={},t=i.createContext(r);function o(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);